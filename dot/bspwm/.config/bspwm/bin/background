#!/usr/bin/env sh

C="$HOME/.config/bspwm/s/background-cmd"
L="$HOME/.config/bspwm/s/background-loop"

G=$(pgrep -fx "$($C)")
if [ "$G" ]; then
    [ "$1" = 'exit' ] && pkill -fx "$($C)" -TERM
    exit 1
fi

bspc rule --remove 'st-background-term' manage=off
while true; do
    bspc rule --add 'st-background-term' manage=off
    bspc rule --list | grep -q 'st-background-term:\*:\* => manage=off' \
        && break
    sleep 1
done

st -c st-background-term -g '227x59+2+0' "$L"
